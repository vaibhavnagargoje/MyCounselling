{% extends "user/base_user.html" %}
{% load static %}

{% block title %}Profile | EduCounsel{% endblock %}

{% block breadcrumbs %}
<div class="bg-white rounded-2xl shadow-sm px-6 py-4 flex items-center space-x-2 text-sm text-gray-600">
    <a href="{% url 'dashboard:home:home' %}" class="flex items-center hover:text-primary transition-colors duration-300">
        <i class="fas fa-home mr-1"></i>Home
    </a>
    <i class="fas fa-chevron-right text-gray-400 text-xs"></i>
    <a href="{% url 'user:overview' %}" class="hover:text-primary transition-colors duration-300">Profile</a>
    <i class="fas fa-chevron-right text-gray-400 text-xs"></i>
    <span class="text-primary font-semibold">Edit Profile</span>
</div>
{% endblock %}

{% block content %}
<div class="space-y-6">
    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
        <div class="h-40 bg-gradient-to-br from-primary via-secondary to-accent relative">
            <div class="absolute inset-0 opacity-10 bg-[url('data:image/svg+xml,%3Csvg width=\"60\" height=\"60\" viewBox=\"0 0 60 60\" xmlns=\"http://www.w3.org/2000/svg\"%3E%3Cg fill=\"none\" fill-rule=\"evenodd\"%3E%3Cg fill=\"%23ffffff\" fill-opacity=\"0.4\"%3E%3Cpath d=\"M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z\"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')]"></div>
        </div>
        <div class="px-6 pb-6">
            <div class="flex flex-col sm:flex-row sm:items-end -mt-12 sm:-mt-16">
                <div class="relative">
                    {% if profile.profile_picture %}
                        <img src="{{ profile.profile_picture.url }}" alt="Profile picture" class="w-28 h-28 rounded-2xl border-4 border-white object-cover shadow-xl">
                    {% else %}
                        <div class="w-28 h-28 rounded-2xl border-4 border-white bg-gradient-to-br from-primary to-secondary flex items-center justify-center shadow-xl">
                            <i class="fas fa-user text-white text-3xl"></i>
                        </div>
                    {% endif %}
                </div>
                <div class="mt-4 sm:mt-0 sm:ml-6">
                    <h1 class="text-3xl font-bold text-dark">{{ user.first_name|default:user.username }} {{ user.last_name }}</h1>
                    <p class="text-gray-600 mt-1">{{ user.email }}</p>
                    <div class="flex flex-wrap items-center gap-2 mt-2">
                        {% if profile.is_verified %}
                            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-success/10 text-success border border-success/20">
                                <i class="fas fa-check-circle mr-1"></i>Verified Student
                            </span>
                        {% endif %}
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-primary/10 text-primary border border-primary/20">
                            <i class="fas fa-calendar mr-1"></i>Member since {{ user.date_joined|date:"M Y" }}
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 gap-4">
            <div>
                <h2 class="text-2xl font-bold text-dark">Profile Information</h2>
                <p class="text-gray-600 mt-1">Update your personal details to keep your profile up to date.</p>
            </div>
            <a href="{% url 'user:overview' %}" class="inline-flex items-center px-5 py-2.5 rounded-xl bg-light text-gray-700 hover:bg-gray-100 transition-all duration-300">
                <i class="fas fa-arrow-left mr-2"></i>Back to Overview
            </a>
        </div>

        <form method="post" enctype="multipart/form-data" action="{% url 'user:user_profile' %}" class="space-y-8">
            {% csrf_token %}

            <section>
                <h3 class="text-lg font-semibold text-dark mb-4 border-b border-gray-200 pb-2">Personal Information</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2" for="first_name">First Name</label>
                        <input id="first_name" name="first_name" type="text" value="{{ user.first_name }}" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-300" placeholder="Enter first name">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2" for="last_name">Last Name</label>
                        <input id="last_name" name="last_name" type="text" value="{{ user.last_name }}" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-300" placeholder="Enter last name">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Email Address</label>
                        <div class="px-4 py-3 border-2 border-gray-200 rounded-lg bg-light text-gray-700">{{ user.email }}</div>
                        <p class="text-xs text-gray-500 mt-1">Email cannot be changed.</p>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2" for="phone_number">Phone Number</label>
                        <input id="phone_number" name="phone_number" type="tel" value="{{ profile.phone_number }}" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-300" placeholder="+1 (555) 000-0000">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2" for="date_of_birth">Date of Birth</label>
                        <input id="date_of_birth" name="date_of_birth" type="date" value="{{ profile.date_of_birth|date:'Y-m-d' }}" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-300">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2" for="gender">Gender</label>
                        <select id="gender" name="gender" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-300">
                            <option value="">Select gender...</option>
                            {% for value, label in profile.GENDER_CHOICES %}
                                <option value="{{ value }}" {% if profile.gender == value %}selected{% endif %}>{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </section>

            <section>
                <h3 class="text-lg font-semibold text-dark mb-4 border-b border-gray-200 pb-2">Address Information</h3>
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2" for="address">Street Address</label>
                        <textarea id="address" name="address" rows="3" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-300" placeholder="Enter your street address">{{ profile.address }}</textarea>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2" for="city">City</label>
                            <input id="city" name="city" type="text" value="{{ profile.city }}" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-300" placeholder="City">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2" for="state">State/Province</label>
                            <input id="state" name="state" type="text" value="{{ profile.state }}" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-300" placeholder="State">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2" for="pin_code">ZIP/PIN Code</label>
                            <input id="pin_code" name="pin_code" type="text" value="{{ profile.pin_code }}" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-300" placeholder="ZIP/PIN">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2" for="country">Country</label>
                        <input id="country" name="country" type="text" value="{{ profile.country }}" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-300" placeholder="Country">
                    </div>
                </div>
            </section>

            <section>
                <h3 class="text-lg font-semibold text-dark mb-4 border-b border-gray-200 pb-2">Additional Information</h3>
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2" for="bio">Bio</label>
                        <textarea id="bio" name="bio" rows="5" maxlength="500" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-300" placeholder="Write a short bio about yourself...">{{ profile.bio }}</textarea>
                        <p class="text-xs text-gray-500 mt-1">Maximum 500 characters.</p>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2" for="website">Website/Portfolio</label>
                        <input id="website" name="website" type="url" value="{{ profile.website }}" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-300" placeholder="https://yourwebsite.com">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2" for="profile_picture">Profile Picture</label>
                        <input id="profile_picture" name="profile_picture" type="file" accept="image/*" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-300">
                        <p class="text-xs text-gray-500 mt-1">Recommended: Square image, at least 400x400px.</p>
                    </div>
                </div>
            </section>

            <div class="flex flex-col sm:flex-row gap-3 sm:justify-end">
                <a href="{% url 'user:overview' %}" class="inline-flex items-center justify-center px-5 py-3 rounded-xl border-2 border-gray-200 text-gray-600 hover:bg-gray-100 transition-all duration-300">
                    Cancel
                </a>
                <button type="submit" class="inline-flex items-center justify-center px-6 py-3 rounded-xl bg-primary text-white font-semibold shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300">
                    <i class="fas fa-save mr-2"></i>Save Changes
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}