{% extends "dashboard/core_base.html" %}
{% load static %}

{% block title %}{{ college.college_name }} | EduCounsel{% endblock title %}

{% block head %}
<meta name="description" content="Detailed information about {{ college.college_name }} - Placements, Rankings, Contact Details">
{% endblock head %}

{% block content %}
<div class="flex-1 ml-64 p-6 space-y-6">
    <!-- Breadcrumb -->
    <nav class="flex items-center space-x-2 text-sm text-gray-500">
        <a href="{% url 'dashboard:colleges:colleges' %}" class="inline-flex items-center gap-2 rounded-lg px-3 py-1.5 bg-white border border-gray-200 text-gray-600 hover:text-blue-600 hover:border-blue-200 transition">
            <i class="fas fa-university"></i>
            <span>College Directory</span>
        </a>
        <i class="fas fa-chevron-right text-gray-300"></i>
        <span class="text-gray-700 font-medium">{{ college.college_name|truncatechars:28 }}</span>
    </nav>

    <!-- Profile Header -->
    <section class="bg-white border border-gray-200 rounded-2xl shadow-sm overflow-hidden">
        <div class="relative bg-gradient-to-r from-blue-700 via-indigo-600 to-blue-800 px-6 py-7 text-white">
            <div class="flex flex-col lg:flex-row lg:items-end lg:justify-between gap-6">
                <div class="space-y-4">
                    <div class="flex flex-wrap items-center gap-2">
                        {% if college.college_code %}
                        <span class="inline-flex items-center space-x-2 px-3 py-1 rounded-full bg-white/15 text-sm font-semibold tracking-wide">
                            <i class="fas fa-hashtag"></i>
                            <span>{{ college.college_code }}</span>
                        </span>
                        {% endif %}
                        {% if college.is_approved %}
                        <span class="inline-flex items-center space-x-2 px-3 py-1 rounded-full bg-emerald-400/90 text-gray-900 text-sm font-semibold">
                            <i class="fas fa-check-circle"></i>
                            <span>Approved Institution</span>
                        </span>
                        {% endif %}
                        {% if college.affiliation %}
                        <span class="inline-flex items-center space-x-2 px-3 py-1 rounded-full bg-white/15 text-sm">
                            <i class="fas fa-building"></i>
                            <span>{{ college.affiliation }}</span>
                        </span>
                        {% endif %}
                    </div>

                    <div class="space-y-2">
                        <h1 class="text-3xl lg:text-4xl font-bold leading-tight">{{ college.college_name }}</h1>
                        <div class="flex flex-wrap items-center gap-4 text-sm text-blue-100">
                            <span class="inline-flex items-center gap-2">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>{{ college.location|default:"Location not available" }}</span>
                            </span>
                            {% if college.established_year %}
                            <span class="inline-flex items-center gap-2">
                                <i class="fas fa-calendar-alt"></i>
                                <span>Established {{ college.established_year }}</span>
                            </span>
                            {% endif %}
                            {% if college.status %}
                            <span class="inline-flex items-center gap-2">
                                <i class="fas fa-info-circle"></i>
                                <span>Status: {{ college.status }}</span>
                            </span>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <div class="flex flex-col sm:flex-row lg:flex-col gap-3">
                    {% if college.website %}
                    <a href="{{ college.website }}" target="_blank" class="inline-flex items-center justify-center gap-2 px-5 py-3 text-sm font-semibold bg-white text-blue-700 rounded-xl shadow-sm hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-white/60">
                        <i class="fas fa-external-link-alt"></i>
                        <span>Visit official site</span>
                    </a>
                    {% endif %}
                    <button type="button" data-action="favorite" class="inline-flex items-center justify-center gap-2 px-5 py-3 text-sm font-semibold bg-white/15 text-white rounded-xl border border-white/30 hover:bg-white/25 focus:outline-none focus:ring-2 focus:ring-white/60">
                        <i class="far fa-heart"></i>
                        <span>Add to favorites</span>
                    </button>
                </div>
            </div>

            <div class="mt-6 grid grid-cols-1 sm:grid-cols-3 gap-4">
                <div class="bg-white/10 rounded-xl px-4 py-3">
                    <p class="text-xs uppercase tracking-wide text-blue-100/80">NIRF Ranking</p>
                    <p class="mt-1 text-lg font-semibold">{{ college.nirf_ranking|default:"Not reported" }}</p>
                </div>
                <div class="bg-white/10 rounded-xl px-4 py-3">
                    <p class="text-xs uppercase tracking-wide text-blue-100/80">National Ranking</p>
                    <p class="mt-1 text-lg font-semibold">{{ college.national_ranking|default:"Not reported" }}</p>
                </div>
                <div class="bg-white/10 rounded-xl px-4 py-3">
                    <p class="text-xs uppercase tracking-wide text-blue-100/80">State Ranking</p>
                    <p class="mt-1 text-lg font-semibold">{{ college.state_ranking|default:"Not reported" }}</p>
                </div>
            </div>
        </div>

        {% if college.description %}
        <div class="px-6 py-5 bg-white/90 backdrop-blur-sm border-t border-gray-100">
            <h2 class="text-sm font-semibold uppercase tracking-wide text-gray-500 mb-2">At a glance</h2>
            <p class="text-sm text-gray-600 leading-relaxed">{{ college.description }}</p>
        </div>
        {% endif %}
    </section>

    <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
        <!-- Detailed Overview -->
        <div class="xl:col-span-2 space-y-6">
            <!-- Quick facts -->
            <section class="bg-white border border-gray-200 rounded-2xl shadow-sm p-6">
                <div class="flex items-center justify-between mb-5">
                    <h2 class="text-lg font-semibold text-gray-900">Institution snapshot</h2>
                    <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold bg-blue-50 text-blue-700">
                        <i class="fas fa-layer-group"></i>
                        <span>Core facts</span>
                    </span>
                </div>
                <dl class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    {% if college.affiliation %}
                    <div class="rounded-xl border border-gray-100 px-4 py-3">
                        <dt class="text-xs uppercase tracking-wide text-gray-500">Affiliation</dt>
                        <dd class="mt-1 text-sm font-medium text-gray-900">{{ college.affiliation }}</dd>
                    </div>
                    {% endif %}
                    {% if college.status %}
                    <div class="rounded-xl border border-gray-100 px-4 py-3">
                        <dt class="text-xs uppercase tracking-wide text-gray-500">Institution status</dt>
                        <dd class="mt-1 text-sm font-medium text-gray-900">{{ college.status }}</dd>
                    </div>
                    {% endif %}
                    {% if college.established_year %}
                    <div class="rounded-xl border border-gray-100 px-4 py-3">
                        <dt class="text-xs uppercase tracking-wide text-gray-500">Founded</dt>
                        <dd class="mt-1 text-sm font-medium text-gray-900">{{ college.established_year }}</dd>
                    </div>
                    {% endif %}
                    <div class="rounded-xl border border-gray-100 px-4 py-3">
                        <dt class="text-xs uppercase tracking-wide text-gray-500">Category</dt>
                        <dd class="mt-1 text-sm font-medium text-gray-900">Engineering College</dd>
                    </div>
                    {% if college.location %}
                    <div class="rounded-xl border border-gray-100 px-4 py-3">
                        <dt class="text-xs uppercase tracking-wide text-gray-500">Location</dt>
                        <dd class="mt-1 text-sm font-medium text-gray-900">{{ college.location }}</dd>
                    </div>
                    {% endif %}
                    {% if college.country %}
                    <div class="rounded-xl border border-gray-100 px-4 py-3">
                        <dt class="text-xs uppercase tracking-wide text-gray-500">Country</dt>
                        <dd class="mt-1 text-sm font-medium text-gray-900">{{ college.country }}</dd>
                    </div>
                    {% endif %}
                </dl>
            </section>

            <!-- Rankings & Recognition -->
            <section class="bg-white border border-gray-200 rounded-2xl shadow-sm p-6">
                <div class="flex items-center justify-between mb-5">
                    <h2 class="text-lg font-semibold text-gray-900">Rankings & Recognition</h2>
                    <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold bg-amber-50 text-amber-700">
                        <i class="fas fa-award"></i>
                        <span>Performance metrics</span>
                    </span>
                </div>
                {% if college.nirf_ranking or college.national_ranking or college.state_ranking %}
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    {% if college.nirf_ranking %}
                    <article class="rounded-xl border border-amber-100 bg-amber-50 px-4 py-6 text-center">
                        <p class="text-xs uppercase tracking-wide text-amber-500">NIRF position</p>
                        <p class="mt-2 text-3xl font-bold text-amber-700">{{ college.nirf_ranking }}</p>
                    </article>
                    {% endif %}
                    {% if college.national_ranking %}
                    <article class="rounded-xl border border-blue-100 bg-blue-50 px-4 py-6 text-center">
                        <p class="text-xs uppercase tracking-wide text-blue-500">National rank</p>
                        <p class="mt-2 text-3xl font-bold text-blue-700">{{ college.national_ranking }}</p>
                    </article>
                    {% endif %}
                    {% if college.state_ranking %}
                    <article class="rounded-xl border border-emerald-100 bg-emerald-50 px-4 py-6 text-center">
                        <p class="text-xs uppercase tracking-wide text-emerald-500">State rank</p>
                        <p class="mt-2 text-3xl font-bold text-emerald-700">{{ college.state_ranking }}</p>
                    </article>
                    {% endif %}
                </div>
                {% else %}
                <div class="rounded-xl border border-dashed border-gray-200 px-5 py-10 text-center text-sm text-gray-500">
                    Ranking information hasn’t been published for this institution yet.
                </div>
                {% endif %}
            </section>

            <!-- Placement Records -->
            <section class="bg-white border border-gray-200 rounded-2xl shadow-sm p-6">
                <div class="flex items-center justify-between mb-5">
                    <h2 class="text-lg font-semibold text-gray-900">Placement Highlights</h2>
                    <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold bg-emerald-50 text-emerald-700">
                        <i class="fas fa-briefcase"></i>
                        <span>Career outcomes</span>
                    </span>
                </div>
                {% if placement_records %}
                <div class="space-y-4">
                    {% for record in placement_records %}
                    <article class="rounded-2xl border border-gray-100 px-4 py-4 hover:border-blue-200 hover:shadow-sm transition">
                        <header class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4">
                            <div>
                                <p class="text-xs uppercase tracking-wide text-gray-500">Academic year</p>
                                <h3 class="text-lg font-semibold text-gray-900">{{ record.academic_year }}</h3>
                            </div>
                            {% if record.placement_percentage %}
                            <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-emerald-100 text-emerald-700 text-xs font-semibold">
                                <i class="fas fa-chart-line"></i>
                                <span>{{ record.placement_percentage }}% students placed</span>
                            </span>
                            {% endif %}
                        </header>

                        <dl class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            {% if record.total_students %}
                            <div class="rounded-xl bg-blue-50 px-3 py-4 text-center">
                                <dt class="text-xs uppercase tracking-wide text-blue-500">Total students</dt>
                                <dd class="mt-1 text-xl font-semibold text-blue-700">{{ record.total_students }}</dd>
                            </div>
                            {% endif %}
                            {% if record.students_placed %}
                            <div class="rounded-xl bg-emerald-50 px-3 py-4 text-center">
                                <dt class="text-xs uppercase tracking-wide text-emerald-500">Students placed</dt>
                                <dd class="mt-1 text-xl font-semibold text-emerald-700">{{ record.students_placed }}</dd>
                            </div>
                            {% endif %}
                            {% if record.highest_package %}
                            <div class="rounded-xl bg-purple-50 px-3 py-4 text-center">
                                <dt class="text-xs uppercase tracking-wide text-purple-500">Highest package</dt>
                                <dd class="mt-1 text-xl font-semibold text-purple-700">₹{{ record.highest_package }} LPA</dd>
                            </div>
                            {% endif %}
                            {% if record.average_package %}
                            <div class="rounded-xl bg-orange-50 px-3 py-4 text-center">
                                <dt class="text-xs uppercase tracking-wide text-orange-500">Average package</dt>
                                <dd class="mt-1 text-xl font-semibold text-orange-600">₹{{ record.average_package }} LPA</dd>
                            </div>
                            {% endif %}
                        </dl>

                        {% if record.top_recruiters %}
                        <div class="mt-4 border-t border-gray-100 pt-3">
                            <p class="text-xs uppercase tracking-wide text-gray-500 mb-2">Top recruiters</p>
                            <div class="flex flex-wrap gap-2">
                                {% for recruiter in record.get_top_recruiters_list %}
                                <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-blue-50 text-blue-700">{{ recruiter }}</span>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}
                    </article>
                    {% endfor %}
                </div>
                {% else %}
                <div class="rounded-xl border border-dashed border-gray-200 px-5 py-10 text-center text-sm text-gray-500">
                    Placement insights will be published once verified data is available.
                </div>
                {% endif %}
            </section>
        </div>

        <!-- Sidebar -->
        <aside class="space-y-6">
            <!-- Contact card -->
            <section class="bg-white border border-gray-200 rounded-2xl shadow-sm p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-base font-semibold text-gray-900">Contact Details</h3>
                    <span class="inline-flex items-center gap-2 text-xs text-gray-500">
                        <i class="fas fa-id-card"></i>
                        <span>Admissions desk</span>
                    </span>
                </div>
                <ul class="space-y-4 text-sm text-gray-600">
                    {% if college.address %}
                    <li class="flex gap-3">
                        <i class="fas fa-map-marker-alt mt-1 text-blue-500"></i>
                        <div>
                            <p class="font-medium text-gray-800">Campus address</p>
                            <p>{{ college.address }}</p>
                            {% if college.pincode %}
                            <p>PIN {{ college.pincode }}</p>
                            {% endif %}
                        </div>
                    </li>
                    {% endif %}
                    {% if college.phone %}
                    <li class="flex gap-3">
                        <i class="fas fa-phone-alt mt-1 text-blue-500"></i>
                        <div>
                            <p class="font-medium text-gray-800">Phone</p>
                            <a href="tel:{{ college.phone }}" class="text-blue-600 hover:text-blue-800">{{ college.phone }}</a>
                        </div>
                    </li>
                    {% endif %}
                    {% if college.email %}
                    <li class="flex gap-3">
                        <i class="fas fa-envelope mt-1 text-blue-500"></i>
                        <div>
                            <p class="font-medium text-gray-800">Email</p>
                            <a href="mailto:{{ college.email }}" class="text-blue-600 hover:text-blue-800">{{ college.email }}</a>
                        </div>
                    </li>
                    {% endif %}
                    {% if college.website %}
                    <li class="flex gap-3">
                        <i class="fas fa-globe mt-1 text-blue-500"></i>
                        <div>
                            <p class="font-medium text-gray-800">Website</p>
                            <a href="{{ college.website }}" target="_blank" class="text-blue-600 hover:text-blue-800">Visit official website</a>
                        </div>
                    </li>
                    {% endif %}
                    {% if not college.address and not college.phone and not college.email and not college.website %}
                    <li class="text-sm text-gray-400">Official contact information isn’t available at the moment.</li>
                    {% endif %}
                </ul>
            </section>

            <!-- Action center -->
            <section class="bg-white border border-gray-200 rounded-2xl shadow-sm p-6">
                <h3 class="text-base font-semibold text-gray-900 mb-4">Action Center</h3>
                <div class="space-y-3">
                    <button type="button" class="w-full inline-flex items-center justify-center gap-2 rounded-xl bg-blue-600 px-4 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-200">
                        <i class="fas fa-user-tie"></i>
                        <span>Book counselling</span>
                    </button>
                    <button type="button" class="w-full inline-flex items-center justify-center gap-2 rounded-xl bg-emerald-500 px-4 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-emerald-600 focus:outline-none focus:ring-2 focus:ring-emerald-200">
                        <i class="fas fa-download"></i>
                        <span>Download brochure</span>
                    </button>
                    <button type="button" class="w-full inline-flex items-center justify-center gap-2 rounded-xl bg-purple-500 px-4 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-200">
                        <i class="fas fa-balance-scale"></i>
                        <span>Compare institutions</span>
                    </button>
                </div>
            </section>

            <!-- Share & navigation -->
            <section class="bg-white border border-gray-200 rounded-2xl shadow-sm p-6">
                <h3 class="text-base font-semibold text-gray-900 mb-4">Share & Explore</h3>
                <div class="space-y-3">
                    <a href="{% url 'dashboard:colleges:colleges' %}" class="w-full inline-flex items-center justify-center gap-2 rounded-xl border border-gray-200 px-4 py-2.5 text-sm font-semibold text-gray-700 hover:border-blue-200 hover:text-blue-600">
                        <i class="fas fa-arrow-left"></i>
                        <span>Back to directory</span>
                    </a>
                    <button type="button" data-action="share" class="w-full inline-flex items-center justify-center gap-2 rounded-xl border border-blue-200 px-4 py-2.5 text-sm font-semibold text-blue-700 hover:bg-blue-50">
                        <i class="fas fa-share-alt"></i>
                        <span>Share profile</span>
                    </button>
                </div>
            </section>
        </aside>
    </div>
</div>
{% endblock content %}

{% block script %}
<script>
    // Favorite button functionality
    document.querySelector('[data-action="favorite"]')?.addEventListener('click', function() {
        const icon = this.querySelector('i');
        if (icon.classList.contains('far')) {
            icon.classList.remove('far');
            icon.classList.add('fas');
            this.innerHTML = '<i class="fas fa-heart mr-2"></i>Remove from Favorites';
            this.classList.remove('bg-white/20');
            this.classList.add('bg-red-500');
        } else {
            icon.classList.remove('fas');
            icon.classList.add('far');
            this.innerHTML = '<i class="far fa-heart mr-2"></i>Add to Favorites';
            this.classList.remove('bg-red-500');
            this.classList.add('bg-white/20');
        }
    });

    // Share functionality
    document.querySelector('[data-action="share"]')?.addEventListener('click', function() {
        if (navigator.share) {
            navigator.share({
                title: '{{ college.college_name }}',
                text: 'Check out {{ college.college_name }} - {{ college.location }}',
                url: window.location.href
            });
        } else {
            // Fallback: copy to clipboard
            navigator.clipboard.writeText(window.location.href).then(() => {
                alert('College link copied to clipboard!');
            });
        }
    });
</script>
{% endblock script %}
